{"totalCount":1,"grade":"D","repositories":[{"url":"https://github.com/MTES-MCT/envergo","grade":"D","alerts":[{"number":2,"created_at":"2022-09-30T08:30:14Z","updated_at":"2023-05-15T08:40:14Z","url":"https://api.github.com/repos/MTES-MCT/envergo/code-scanning/alerts/2","html_url":"https://github.com/MTES-MCT/envergo/security/code-scanning/2","state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"pythonsecurity:S5145","severity":"warning","description":"Logging should not be vulnerable to injection attacks","name":"pythonsecurity:S5145","tags":["cwe"],"full_description":"Logging should not be vulnerable to injection attacks","help":"<h2>Why is this an issue?</h2>\n<p>Log injection occurs when an application fails to sanitize untrusted data used for logging.</p>\n<p>An attacker can forge log content to prevent an organization from being able to trace back malicious activities.</p>\n<h3>What is the potential impact?</h3>\n<p>If an attacker can insert arbitrary data into a log file, the integrity of the chain of events being recorded can be compromised.<br> This\nfrequently occurs because attackers can inject the log entry separator of the logger framework, commonly newlines, and thus insert artificial log\nentries. <br> Other attacks could also occur requiring only field pollution, such as cross-site scripting (XSS) or code injection (for example,\nLog4Shell) if the logged data is fed to other application components, which may interpret the injected data differently.<br></p>\n<p>The focus of this rule is newline character replacement.</p>\n<h4>Log Forge</h4>\n<p>An attacker, able to create independent log entries by injecting log entry separators, inserts bogus data into a log file to conceal his malicious\nactivities. This obscures the content for an incident response team to trace the origin of the breach as the indicators of compromise (IoCs) lead to\nfake application events.</p>\n<h2>How to fix it in Flask</h2>\n<h3>Code examples</h3>\n<p>The following code is vulnerable to log injection as it constructs log entries using untrusted data. An attacker can leverage this to manipulate\nthe chain of events being recorded.</p>\n<h4>Noncompliant code example</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"noncompliant\">\nimport logging\n\napp = Flask(__name__)\n\n@app.route('/example')\ndef log():\n    data = request.args[\"data\"]\n    app.logger.critical(\"%s\", data) # Noncompliant\n</pre>\n<h4>Compliant solution</h4>\n<pre data-diff-id=\"1\" data-diff-type=\"compliant\">\nimport logging\nimport base64\n\napp = Flask(__name__)\n\n@app.route('/example')\ndef log():\n    data = request.args[\"data\"]\n    if data.isalnum():\n        app.logger.critical(\"%s\", data)\n    else:\n        app.logger.critical(\"Invalid Input: %s\", base64.b64encode(data.encode('UTF-8')))\n</pre>\n<h3>How does this work?</h3>\n<p>Data used for logging should be content-restricted and typed. This can be done by validating the data content or sanitizing it.<br> Validation and\nsanitization mainly revolve around preventing carriage return (CR) and line feed (LF) characters. However, further actions could be required based on\nthe application context and the logged data usage.</p>\n<p>Here, the example compliant code uses the <code>isalnum</code> function to ensure the untrusted data is safe. If not, it performs Base64 encoding\nto protect from log injection.</p>\n<h2>Resources</h2>\n<h3>Standards</h3>\n<ul>\n  <li> <a href=\"https://owasp.org/Top10/A03_2021-Injection/\">OWASP Top 10 2021 Category A3</a> - Injection </li>\n  <li> <a href=\"https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/\">OWASP Top 10 2021 Category A9</a> - Security Logging and\n  Monitoring Failures </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A1_2017-Injection\">OWASP Top 10 2017 Category A1</a> - Injection </li>\n  <li> <a href=\"https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring\">OWASP Top 10 2017 Category A10</a> -\n  Insufficient Logging &amp; Monitoring </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/20\">MITRE, CWE-20</a> - Improper Input Validation </li>\n  <li> <a href=\"https://cwe.mitre.org/data/definitions/117\">MITRE, CWE-117</a> - Improper Output Neutralization for Logs </li>\n</ul>","security_severity_level":"low"},"tool":{"name":"SonarCloud","guid":null,"version":null},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"(default)","environment":"{}","category":"","state":"open","commit_sha":"318fb436ea2ff3583a20541f16d03fbe31112a5c","message":{"text":"<!--SONAR_ISSUE_KEY:AYONhGhNnAcKouvelHBO-->Change this code to not log user-controlled data. <p>See more on <a href=\"https://sonarcloud.io/project/issues?id=MTES-MCT_envergo&issues=AYONhGhNnAcKouvelHBO&open=AYONhGhNnAcKouvelHBO\">SonarCloud</a></p>"},"location":{"path":"envergo/analytics/utils.py","start_line":40,"end_line":40,"start_column":5,"end_column":79},"classifications":[]},"instances_url":"https://api.github.com/repos/MTES-MCT/envergo/code-scanning/alerts/2/instances"}]}]}